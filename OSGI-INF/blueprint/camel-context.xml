<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.0.0"
           xsi:schemaLocation="
             http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
             http://camel.apache.org/schema/blueprint http://camel.apache.org/schema/blueprint/camel-blueprint.xsd">
    
  <camelContext xmlns="http://camel.apache.org/schema/blueprint"
                  xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                  id="storage-proxy-context">
                  
      <route id="ruby-test" autoStartup="true">
        <from uri="timer:simple?repeatCount=1"/>
        <log message="Ruby Test route start"/>
        <setHeader headerName="storage_id"><simple>1234abcd</simple></setHeader>
        <setHeader headerName="ruby_eval"><simple>StorageProxy.status('${header.storage_id}')</simple></setHeader>
        <setBody>
          <ruby>resource:classpath:storage_proxy.rb</ruby>
        </setBody>
        <to uri="direct:body-log"/>
      </route>
      
      <route id="body-log">
        <from uri="direct:body-log"/>
        <log message="${body}"/>
      </route>
    </camelContext>
</blueprint>
